{% extends "base.html" %}
{% block title %}Conversation{% endblock %}

{% block content %}
<div class="page-header">
  <h1>Conversation #{{ thread.id }}</h1>
  <p class="page-subtitle">
    Participants:
    {{ thread.participants.all|join:", " }}
  </p>
</div>

<div class="card messages-thread">
  {% if thread.messages.all %}
    <div class="messages-log">
      {% for m in thread.messages.all %}
        <div class="message-row {% if m.sender == request.user %}me{% endif %}">
          <div class="message-meta">
            <strong>{{ m.sender.username }}</strong>
            <span class="muted">{{ m.created_at|date:"Y-m-d H:i" }}</span>
          </div>
          <div class="message-body">
            {{ m.body|linebreaksbr }}
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No messages yet. Start the conversation below.</p>
  {% endif %}
</div>

<form method="post" class="card mt-2">
  {% csrf_token %}
  <label for="id_body">New message</label>
  <textarea id="id_body" name="body" rows="3" required></textarea>
  <button type="submit" class="btn btn-primary mt-1">Send</button>
</form>
{% endblock %}
